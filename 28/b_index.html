<doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<title>ES7 Decorators - Alexander Mayorov, MoscowJS 28</title>

	<meta name="description" content="ES7 Decorators - Alexander Mayorov, MoscowJS 28">
	<meta name="author" content="Alexander Mayorov">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/white.css" id="theme">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="lib/css/github-gist.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement('link');
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName('head')[0].appendChild(link);
	</script>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
</head>

<body>

<div class="reveal">

	<!-- Any section element inside of this container is displayed as a slide -->
	<ul class="slides">
		<section>
			<h1>ES Decor@tors</h1>
			<h3>–î–µ–ª–∞–µ–º –∫—Ä–∞—Å–∏–≤–æ</h3>
			<p>
				<small>Created by Alexander <a href="http://majorov.su">Mayorov@tutu.ru</a> /
					<a href="https://medium.com/@frontman">@frontman</a></small>
			</p>
		</section>

		<section>
			<section>
				<h2>Angular2</h2>
<pre><code class="hljs" data-trim>
import {Component} from 'angular2/core';

@Component({
  selector: 'my-app',
  template: '<h1>My First Angular 2 App</h1>'
})

export class AppComponent { }
</code></pre>
			</section>
			<section>
				<h2>Redux</h2>
<pre><code class="hljs" data-trim>
import { bindActionCreators } from 'redux';
import { connect } from 'react-redux';

@connect(mapStateToProps, mapDispatchToProps)
export default class MyApp extends React.Component {
  // ...define your main app here
}
</code></pre>
			</section>
		</section>

		<section>
			<section>
				<img src="images/commercial-at.png" alt="">
			</section>
			<section>
				<h2>@</h2>
				<p>–í —è–∑—ã–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:</p>
				<ul>
					<li class="fragment">Ruby ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞</li>
					<li class="fragment">PHP ‚Äî –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞</li>
					<li class="fragment">CoffeeScript ‚Äî –∞–ª–∏–∞—Å –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ this</li>
					<li class="fragment">Java ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏</li>
					<li class="fragment">Python ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞</li>
					<li class="fragment">ES/TS ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞</li>
				</ul>
			</section>
		</section>

		<section>
			<h2>–î–µ–∫–æ—Ä–∞—Ç–æ—Ä?</h2>
			<ul>
				<li class="fragment">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è</li>
				<li class="fragment">–®–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
			</ul>
		</section>

		<section>
			<h2>–ü–∞—Ç—Ç–µ—Ä–Ω –û–û–ü</h2>
			<blockquote style="text-align: left">
				–î–µ–∫–æ—Ä–∞—Ç–æ—Ä ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —à–∞–±–ª–æ–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
				–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫ –æ–±—ä–µ–∫—Ç—É.
			</blockquote>
		</section>

		<section>
			<h3>–ü—Ä–∏–º–µ—Ä –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞</h3>
			<div>
				<p>–±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è</p>
<pre><code class="hljs" data-trim>
let myCat = black( cat(üê±) );
</code></pre>
			</div>
			<div class="fragment">
				<p>c –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è</p>
<pre><code class="hljs" data-trim>
@black
let myCat = cat(üò∏);
</code></pre>
			</div>
		</section>

		<section>
			<h2>ES7 @Decorator</h2>
			<section>
				<p style="text-align: left" class="fragment">
					–í—ã—Ä–∞–∂–µ–Ω–∏–µ, –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –æ–±—ä–µ–∫—Ç, –∏–º—è –∏ –¥–µ–∫—Å—Ä–∏–ø—Ç–æ—Ä –¥–µ–∫–æ—Ä–∏—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.
					–ú–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏–ª–∏ –Ω–∏—á–µ–≥–æ.
				</p>
			</section>
			<section>
				<p>–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:</p>
				<ul>
					<li>–¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è</li>
					<li>–∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
				</ul>
			</section>
		</section>


		<section>
			<h2>–ú–æ–∂–Ω–æ –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞—Ç—å</h2>
			<table>
				<thead></thead>
				<tbdoy>
					<tr>
						<td>–ö–ª–∞—Å—Å—ã</td>
						<td>@decorate class A {}</td>
					</tr>
					<tr>
						<td>–ú–µ—Ç–æ–¥—ã</td>
						<td>class A { @decorate foo(){} }</td>
					</tr>
					<tr>
						<td>–ê—Ä–≥—É–º–µ–Ω—Ç—ã*</td>
						<td>class A { foo(@decorate a){} }</td>
					</tr>
					<tr>
						<td>–°–≤–æ–π—Å—Ç–≤–∞</td>
						<td>class A { @decorate foo; }</td>
					</tr>
				</tbdoy>
			</table>
		</section>

		<section>
			<h1>CLASS</h1>
		</section>

		<section>
			<h3>TypeScript signature</h3>
<pre><code class="hljs" data-trim>
declare type ClassDecorator =
  &lt;TFunction extends Function&gt;(target: TFunction)
	=> TFunction | void;
</code></pre>
			<p>target - –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞</p>
		</section>

		<section>
			<h3>ES7 / TS</h3>
<pre><code class="hljs" data-trim>
function classDecorator(target) {
  target.__metadata__ = {
    // –¥–æ–±–∞–≤–ª—è–µ–º –º–∞–≥–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  }
  // return - –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–µ–º –≤–æ–≤—Å–µ –ø–æ–¥–º–µ–Ω–∏—Ç—å
  // –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω—ã–º
}

@classDecorator class A {
  // constructor() {}
}
</code></pre>
		</section>
		<section>
			<h3>–ü—Ä–∏–º–µ—Ä</h3>
<pre><code class="typescript" data-trim>
@Component
class MyComponent {
  template = '<h1>Hello, Moscow!</h1>';
}

let mc = new MyComponent;
let html = mc.render();

function Component(target) {
  target.prototype.render = function() {
    return this.template;
  }
}
</code></pre>
		</section>

		<section>
			<h1>METHOD</h1>
		</section>
		<section>
			<section>
				<h3>TypeScript signature</h3>
<pre><code class="hljs" data-trim>
declare type MethodDecorator =
  &lt;T&gt;(target: Object, propertyKey: string | symbol,
      descriptor: TypedPropertyDescriptor&lt;T&gt;)
        => TypedPropertyDescriptor&lt;T&gt; | void;
</code></pre>
				<ul>
					<li>target - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ç–æ—Ç–∏–ø –∫–ª–∞—Å—Å–∞</li>
					<li>name - –∏–º—è –º–µ—Ç–æ–¥–∞</li>
					<li>descriptor = Object.getOwnPropertyDescriptor(<br>
						target.prototype, name)</li>
				</ul>
			</section>
			<section>
				<h3>Descriptor</h3>
				<div style="text-align: left">
					{
					<ul>
						<li>value</li>
						<li>writable</li>
						<li>get</li>
						<li>set</li>
						<li>configurable</li>
						<li>enumerable</li>
					</ul>
					}
				</div>
			</section>
		</section>
		<section>
			<h3>ES7 / TS</h3>
<pre><code class="typescript" data-trim>
function methodDecorator(target, key, dcr) {
  // do anything with descriptor
  return dcr; // or new object
}

class A {
  @methodDecorator
  foo() {
    // do anything
  }
}
</code></pre>
		</section>
		<section>
			<section>
				<h2>–ü—Ä–∏–º–µ—Ä—ã</h2>
				<h3>–î–µ–∫–æ—Ä –º–µ—Ç–æ–¥–æ–≤</h3>
			</section>
			<section>
				<h3>@Override</h3>
<pre><code class="typescript" data-trim>
class BaseComponent {
  @override
  render(){}
}

class MyComponent extends BaseComponent {
  render() {
    return &lt;h1&gt;Hello!&lt;/h1&gt;
  }
}
</code></pre>
			</section>
			<section>
				<h3>@Deprecated</h3>
<pre><code class="typescript" data-trim>
class BaseComponent {
  @deprecated
  oldMethod(){ /.../ }
}

let component = new BaseComponent;
component.oldMethod(); // Warning: deprecated ...
</code></pre>
			</section>
			<section>
				<h3>@Logger</h3>
<pre><code class="typescript" data-trim>
@log
class Component {
  @log someMethod(){ /.../ }
  @log doAnything(){ /.../ }
}
</code></pre>
			</section>
			<section>
				<h3>@_IF</h3>
<pre><code class="typescript" data-trim>
class Component {

  @_if (User.isAuthenticated)
  function getUserData() {
    return { ... }
  }

}
</code></pre>
			</section>
			<section>
				<h3>@required</h3>
<pre><code class="typescript" data-trim>
function foo(arg1) {
  if (arguments.length < 1 || arg1 === undefined)
    throw new Error('Missing parameters');
  return arg1 + 2;
}
</code></pre>
<pre class="fragment"><code class="typescript" data-trim>
function required(i) { throw new Error(`Missing ${i} parameter`) }

function foo(arg1 = required(1)) {
  return arg1 + 2;
}
</code></pre>
<pre class="fragment"><code class="typescript" data-trim>
@required   ('arg1')
function foo( arg1 ) {
  return arg1 + 2;
}
</code></pre>
			</section>
		</section>

		<section>
			<h1>PROPERTY</h1>
		</section>
		<section>
			<h2>TypeScript signature</h2>
<pre><code class="typescript" data-trim>
declare type PropertyDecorator =
  (target: Object, propertyKey: string | symbol)
	=> void | any;
</code></pre>
			<h3>Babel</h3>
<pre><code class="typescript" data-trim>
function (target, key, descriptor) {
  let defaultValue = descriptor.initializer();
}
</code></pre>
		</section>
		<section>
			<h2>TypeScript</h2>
<pre><code class="typescript" data-trim>
function (target, key, descriptor) {

  // default value for static in target[key]
  if (target.hasOwnProperty(key)) return { ... };

  let metaKey = '__meta__' + key;

  const get = function ():any { return this[metaKey] };

  const set = function&lt;T&gt;(val:T):T {
    // Set default value
    if (this[metaKey] === void 0) return this[metaKey] = val;
    // do anything ...
  }

  return { get, set };
}
</code></pre>
		</section>
		<section>
			<section>
				<h2>–ü—Ä–∏–º–µ—Ä—ã</h2>
				<h3>–î–µ–∫–æ—Ä —Å–≤–æ–π—Å—Ç–≤</h3>
			</section>
			<section>
				<h3>@readonly</h3>
<pre><code class="typescript" data-trim>
class Cat {
  @readonly
  name = 'Simon';
}

let myCat = new Cat;
myCat.name = 'Murzik';
// Throw error: Cannot assign to read only property 'name' of object
</code></pre>
			</section>
			<section>
				<h3>@readonly : Babel</h3>
<pre><code class="typescript" data-trim>
function readonly(target, key, descriptor) {
  descriptor.writable = false;
  return descriptor;
}
</code></pre>
			</section>
			<section>
				<h3>@readonly : TS</h3>
<pre><code class="typescript" data-trim>
function readonly(target, key) :any {

  if (target.hasOwnProperty(key)) return { writable: false };

  let metaKey = '__meta__' + key;

  const get = function ():any { return this[metaKey] };

  const set = function&lt;T&gt;(val:T):T {
    if (this[metaKey] === void 0) return this[metaKey] = val;

    let cls = target.constructor.name;
    throw `Call [${cls}].${key} = '${val}'.
           Cannot assign to read only property '${key}'!`;
  };

  return { get, set };
}
</code></pre>
			</section>
		</section>

		<section>
			<section>
				<h1>PARAMETER</h1>
				<div class="fragment">
					<p>Only in TypeScript</p>
<pre><code class="typescript" data-trim>
declare type ParameterDecorator =
  (target: Object, propertyKey: string | symbol,
     parameterIndex: number)
       => void;
</code></pre>
					<ul>
						<li>target - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ç–æ—Ç–∏–ø –∫–ª–∞—Å—Å–∞</li>
						<li>name - –∏–º—è –º–µ—Ç–æ–¥–∞ –∏–ª–∏ undefined</li>
						<li>index - –Ω–æ–º–µ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–∞</li>
					</ul>
				</div>
			</section>
			<section>
				<h3>Parameter Decorator</h3>
<pre><code class="typescript" data-trim>
class Some {
  constructor(@dec x, @dec y){}
  foo(@dec a, @dec b){}
}
</code></pre>
			</section>
		</section>

		<section>
			<section>
				<h3>Decorator factory</h3>
<pre><code class="typescript" data-trim>
@Component({
  selector: 'my-app'
  template: `<h1>My angular :)</h1>`
})
class MyComponent {}
</code></pre>
			</section>
			<section>
				<h3>Decorator factory</h3>
<pre><code class="typescript" data-trim>
function Component(params){
  // do anything with params

  return function(target) {
	// decorate or annotate target
	// return ?
  }
}
</code></pre>
			</section>
		</section>


		<section>
			<section>
				<h2>–ü—Ä–∏–º–µ—Ä—ã</h2>
			</section>
			<section>
				<h3>RTTS</h3>
				<p>RunTime Type System</p>
			</section>
			<section>
				<h3>RunTime Type System</h3>
<pre><code class="hljs" data-trim>
class A {

  @tstring foo = 'abc';
  @tnumber bar = 123;

  @tfloat foo = 123.321;
  @tint   foo = 123;
}
</code></pre>
			</section>
			<section>
				<h3>RunTime Type System</h3>
<pre><code class="typescript" data-trim>
class A {

  @type someDo(@cast `int` arg) { ... } // eq: @cast('int') arg

  @type `int` doAnything(@cast `float` arg) { return arg }
}
</code></pre>
			</section>
		</section>

		<section>
			<h3>core-decorators.js</h3>
			<a href="https://github.com/jayphelps/core-decorators.js" target="_blank">https://github.com/jayphelps/core-decorators.js</a>
		</section>

		<section>
			<h1>Reflection <br>API</h1>
		</section>

		<section>
			<h2>–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å</h2>
			<p>Babel</p>
<pre><code class="bash" data-trim>
npm install babel-plugin-syntax-decorators
// and add in config
{ "plugins": ["syntax-decorators"] }
</code></pre>
			<p>TypeScript</p>
<pre><code class="bash" data-trim>
tsc --experimentalDecorators
// or add in tsconfig.json
{"compilerOptions":{ "experimentalDecorators": true}}
</code></pre>
		</section>

		<section style="text-align: left;">
			<h1>–°–ø–∞—Å–∏–±–æ!</h1>
			<p>
				<i class="fa fa-envelope-o"></i> Alexander <a href="http://slides.com">Mayorov @ Tutu.ru</a>
				<br><i class="fa fa-facebook-square"></i> <a href="https://www.facebook.com/alexander.majorov">@alexander.majorov</a>
				<br><i class="fa fa-twitter-square"></i> <a href="https://twitter.com/frontdevops">@frontdevops</a>
				<br><i class="fa fa-github-square"></i> <a href="https://github.com/frontdevops">@frontdevops</a>
				<br><i class="fa fa-medium"></i> <a href="https://medium.com/frontman">@frontman</a>
			</p>
		</section>

	</ul>
</div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>
<script>
	// Full list of configuration options available at:
	// https://github.com/hakimel/reveal.js#configuration
	Reveal.initialize({
		controls: true,
		progress: true,
		history: true,
		center: true,
		transition: 'slide', // none/fade/slide/convex/concave/zoom
		// Optional reveal.js plugins
		dependencies: [
			{
				src: 'lib/js/classList.js',
				condition: function () { return !document.body.classList }
			},
			//{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
			//{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
			{
				src: 'plugin/highlight/highlight.js',
				async: true,
				callback: function () { hljs.initHighlightingOnLoad() }
			},
			{
				src: 'plugin/zoom-js/zoom.js',
				async: true},
			{
				src: 'plugin/notes/notes.js',
				async: true
			}
		]
	});
</script>
</body>
</html>
